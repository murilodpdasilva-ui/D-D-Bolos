<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Administração do Estoque</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
<h1>Administração do Estoque</h1>

<input type="text" id="nome" placeholder="Nome do produto">
<input type="text" id="descricao" placeholder="Descrição do produto">
<input type="number" id="preco" placeholder="Preço">
<input type="number" id="quantidade" placeholder="Quantidade disponível">
<button onclick="adicionarProduto()">Adicionar produto</button>
<hr>
<div id="lista-admin"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, doc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCzbARMpHLybFuU-1xFqH0QIc-MuoeRIRE",
  authDomain: "dd-bolos.firebaseapp.com",
  projectId: "dd-bolos",
  storageBucket: "dd-bolos.firebasestorage.app",
  messagingSenderId: "887742402793",
  appId: "1:887742402793:web:e13d26f8e9ca28a94f2078"
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const listaAdmin = document.getElementById("lista-admin");

async function carregarProdutos() {
  const querySnapshot = await getDocs(collection(db, "produtos"));
  listaAdmin.innerHTML="";
  querySnapshot.forEach(docSnap=>{
    const p = docSnap.data(); p.id=docSnap.id;
    listaAdmin.innerHTML+=`<div>${p.nome} - ${p.descricao} - R$ ${Number(p.preco).toFixed(2)} - ${p.quantidade} 
    <button onclick="removerProduto('${p.id}')">Remover</button></div>`;
  });
}

window.adicionarProduto = async function(){
  const nome=document.getElementById("nome").value;
  const descricao=document.getElementById("descricao").value;
  const preco=Number(document.getElementById("preco").value);
  const quantidade=Number(document.getElementById("quantidade").value);
  if(!nome||!descricao||!preco||!quantidade){alert("Preencha todos os campos"); return;}
  await addDoc(collection(db,"produtos"),{nome,descricao,preco,quantidade});
  carregarProdutos();
}

window.removerProduto = async function(id){
  await deleteDoc(doc(db,"produtos",id));
  carregarProdutos();
}

carregarProdutos();
</script>
</body>
</html>
